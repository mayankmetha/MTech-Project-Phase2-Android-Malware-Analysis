import os
import fleep
import shutil
import re

print("I: Removing files with wrong file extensions")
path = os.getcwd()+"/../../dump/"
resPath = ""
for(dpath,dnames,fnames) in os.walk(path):
    if 'res' in dnames:
        resPath = dpath+"/res"
        break

for(dpath,dnames,fnames) in os.walk(dpath+'/res'):
    for _ in fnames:
        with open(dpath+"/"+_,'rb') as file:
            info = fleep.get(file.read(128))
        if _.split(".")[-1] not in info.extension and len(info.extension) != 0:
            print("\t"+dpath+"/"+_+" removed!")
            os.remove(dpath+"/"+_)
            lines = []
            fin = open(resPath+'/values/public.xml','r')
            for f in fin.readlines():
                if re.search('name=\"'+_.split(".")[0]+'\"',f):
                    pass
                else:
                    lines.append(f)
            fin.close()
            fout = open(resPath+'/values/public.xml','w')
            for f in lines:
                fout.writelines(f)
            fout.close()
        